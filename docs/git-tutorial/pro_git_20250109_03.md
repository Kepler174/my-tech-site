---
slug: git-02-06-tagging
title: "2.6 Tagging — 给历史的里程碑刻字"
authors: [yeezi]
tags: [git, progit, 标签, release]
date: 2025-01-09T10:10:00
---

如果你正在开发一个软件，当代码达到一个稳定的状态，准备发布 1.0 版本时，你会怎么做？
你当然不希望用户说：“请下载 SHA-1 校验和为 `9fceb02` 的那个版本。”
用户需要的是：“请下载 v1.0”。

Git 的**标签 (Tag)** 功能，就是用来做这件事的。它允许你在 Git 的提交历史中挑选特定的点，给它打上一个显眼的印记。就像书签一样，方便你随时翻回这一页。

<!--truncate-->

### 两种标签

Git 支持两种标签：**轻量标签 (Lightweight)** 和 **附注标签 (Annotated)**。

1.  **轻量标签**：
    它就像是一个不会移动的分支引用。它只是指向某个特定 commit 的指针。
    ```bash
    $ git tag v1.0-beta
    ```

2.  **附注标签 (推荐)**：
    这是存储在 Git 数据库中的完整对象。它包含打标签者的名字、电子邮件、日期，甚至你可以给标签写一段说明信息。更重要的是，它可以被 GPG 签名，证明这个版本确实是你发布的。
    ```bash
    $ git tag -a v1.0 -m "我的第一个正式版本"
    ```

**专家建议：**
在正式发布软件版本时，**永远使用附注标签** (`-a`)。这样你可以保留发布者的元数据。轻量标签通常只用于本地临时的标记（比如“昨晚代码写到这儿了”）。

### 查看标签

```bash
$ git tag
```

如果标签很多，可以用通配符搜索：

```bash
$ git tag -l "v1.8.5*"
```

### 共享标签

这是个大坑。
默认情况下，`git push` 命令**并不会**把标签传送到远程服务器上。
你辛辛苦苦打好的 tag，推送到 GitHub 上若是没有，同事们是看不到的。

你必须显式地推送标签：

```bash
$ git push origin v1.5
```

或者把所有标签一次性推上去：

```bash
$ git push origin --tags
```

### 检出标签

有时候你需要回退到某个版本去修复 Bug。比如用户报告 v1.0 有问题，你需要回到 v1.0 的代码环境去复现。

```bash
$ git checkout v1.0
```

**警告：**
这会让你的仓库进入“分离头指针 (Detached HEAD)”状态。
简单来说，你现在是在“过去”游荡。如果你在这里修改代码并提交，这些提交是不属于任何分支的。当你一旦切回 `main` 分支，这些在 v1.0 之上的修改就会变成孤魂野鬼，最终被 Git 的垃圾回收机制清除。

如果你需要在 v1.0 的基础上修 Bug，正确的做法是新建一个分支：

```bash
$ git checkout -b version2-fix v1.0
```

### 总结

标签是版本管理的锚点。在混乱的开发洪流中，它们是一块块坚实的里程碑。善用标签，会让你的发布流程变得井井有条。
